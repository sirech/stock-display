(function(){function l(b){$.get(b,function(a){m(a)})}function k(b){if(d.stocks.length!==0){var a=l,e,c;e=[];for(c=0;c<b.length;c++)e.push(b[c].id);b="http://download.finance.yahoo.com/d/quotes.csv?s="+e.join("+")+"&f=";d.format={last_time:0,name:1,last_price:2,percent_change:3,change:4,symbol:5};a(b+(d.modifiers.last_time+d.modifiers.name+d.modifiers.last_price+d.modifiers.percent_change+d.modifiers.change+d.modifiers.symbol))}}function n(b,a){var e,c="http://ichart.finance.yahoo.com/";if(a===d.chartArguments.today||
a===d.chartArguments.lastWeek){c+=a+"?s=";e="&"}else{c+="c/"+a+"/";e="?"}return c+b+e+Math.floor(Math.random()*1E6)}function j(b,a){var e,c;e=d.chartArguments[load("time")]||d.chartArguments.today;$("#chart").data("id",b);$("#chart ul").find("#"+load("time")).addClass("ui-state-active").siblings().removeClass("ui-state-active");c=new Image;c.src=n(b,e);c.onload=function(){$("#chart img").remove();a?$("#chart").append(c):$("#chart").append(c).effect("slide")}}function o(b){var a=d.template.clone().data("id",
b.id).show();a.find(".stock_name").text(b.name);a.click(function(){$(this).addClass("selected").siblings().removeClass("selected");j($(this).data("id"));return false}).mouseenter(function(){$(this).addClass("highlighted").siblings().removeClass("highlighted");return false});a.find(".stock_chg").click(function(){p();return false});return a}function q(){var b,a;if(d.stocks.length===0){r();return false}for(b=0;b<d.stocks.length;b++){a=o(d.stocks[b]);$("#stocks ul").append(a)}return true}function m(b){var a,
e,c,f,g;a=s(b);e=0;c=(b=getBoolKey($("#stocks"),"price_chg"))?d.format.change:d.format.percent_change;f=b?d.format.percent_change:d.format.change;$("#stocks ul .stock").each(function(t,i){var h=a[e];if(h[d.format.symbol]===$(i).data("id")){g=h[c].charAt(0)==="+"?"up":h[c].charAt(0)==="-"?"down":"neutral";$(i).find(".stock_price").text(h[d.format.last_price]);$(i).find(".stock_chg").removeClass("up down neutral").addClass(g).data("alt",h[f]).text(h[c]);e++}else{$(i).find(".stock_price").text("-");
$(i).find(".stock_chg").removeClass("up down neutral").addClass("neutral").data("alt","-").text("-")}});$("#chart img").length!=0&&j($("#chart").data("id"),true)}function r(){$("#empty").show().find("a").click(function(){window.open(chrome.extension.getURL("options.html"));window.close();return false});$("#title").hide();$("#disclaimer").hide();$("#last_update").hide()}function p(){toggleKey($("#stocks"),"price_chg");$("#stocks ul .stock .stock_chg").each(function(b,a){swap($(a),"alt")})}function s(b,
a){var e,c,f,g;a=a||",";e=RegExp("(\\"+a+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+a+"\\r\\n]*))","gi");for(c=[[]];f=e.exec(b);){g=f[1];g.length&&g!==a&&c.push([]);f=f[2]?f[2].replace(RegExp('""',"g"),'"'):f[3];c[c.length-1].push(f)}return c}var d={modifiers:{name:"n",symbol:"s",last_price:"l1",last_time:"t1",percent_change:"p2",change:"c1"},format:{},stocks:loadStocks(),template:stockTemplate(),chartArguments:{today:"b",lastWeek:"w",threeMonths:"3m",sixMonths:"6m",lastYear:"1y",twoYears:"2y",
fiveYears:"5y",max:"my"}};jQuery(function(){$("#status").ajaxStart(function(){$(this).show()});$("#status").ajaxError(function(){$(this).hide()});$("#status").ajaxStop(function(){$(this).fadeOut(2E3)});$("#title").click(function(){window.open(chrome.extension.getURL("standalone.html"));window.close();return false}).mouseenter(function(){$(this).addClass("title_highlight");return false}).mouseleave(function(){$(this).removeClass("title_highlight");return false}).attr("title",chrome.i18n.getMessage("help_standalone")).text(getTitle());
$("#disclaimer").text(chrome.i18n.getMessage("disclaimer"));$("#empty a").text(chrome.i18n.getMessage("empty_add"));$("#time_options li").addClass("ui-state-default").click(function(){store("time",$(this).attr("id"));j($("#chart").data("id"));return false});if(q()){k(d.stocks);window.setInterval(function(){k(d.stocks)},45E3)}})})();
