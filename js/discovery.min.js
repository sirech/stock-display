var config={template:stockConfigTemplate()},YAHOO={Finance:{SymbolSuggest:{}}};function persist(){var b=[];$("#stocks ul .stock").each(function(c,a){var d={id:$(a).find(".stock_id").text(),name:$(a).find(".stock_name").text()};b.push(d)});storeStocks(b)}function stockExists(b){var c,a=loadStocks();for(c=0;c<a.length;c++)if(a[c].id===b)return true;return false}function removeStock(b){b.fadeOut("slow",function(){b.remove();persist()})}
function addStock(b,c){var a=config.template.clone();a.find(".stock_name").text(b.name);a.find(".stock_id").text(b.id);a.find(".delete").click(function(){removeStock($(this).parent());return false});$("#stocks ul").append(a);a.fadeIn("slow");c&&persist()}function unpersist(){var b,c;b=loadStocks();for(c=0;c<b.length;c++)addStock(b[c],false)}function showResults(b,c){b($.map(c,function(a){return{label:a.name+" ("+a.symbol+")"+(a.exchDisp?" in "+a.exchDisp:""),value:{id:a.symbol,name:a.name}}}))}
function setupLookup(){$("#search_field").autocomplete({source:function(b,c){$.ajax({type:"GET",url:"http://d.yimg.com/autoc.finance.yahoo.com/autoc",data:{query:b.term},dataType:"jsonp",jsonpCallback:"YAHOO.Finance.SymbolSuggest.ssCallback"});YAHOO.Finance.SymbolSuggest.ssCallback=function(a){showResults(c,a.ResultSet.Result)}},select:function(b,c){var a=c.item.value;stockExists(a.id)||addStock(a,true);$("#search_field").val(a.name);return false},focus:function(b,c){var a=c.item.value;$("#search_field").val(a.name);
return false},open:function(){$(this).removeClass("ui-corner-all").addClass("ui-corner-top")},close:function(){$(this).removeClass("ui-corner-top").addClass("ui-corner-all")}})}
jQuery(function(){$("#search_field").focus(function(){$(this).removeClass("example").val("")});$("#stocks ul").sortable({handle:".handle",update:function(){persist()}}).disableSelection();document.title=chrome.i18n.getMessage("options_title",[chrome.i18n.getMessage("extension_name")]);$("#stocks_header div #start").text(chrome.i18n.getMessage("start"));$("#stocks_header div #search_field").val(chrome.i18n.getMessage("example",["Apple"]));$("#usage #help_start").text(chrome.i18n.getMessage("help_start"));
$("#usage #help_comp").text(chrome.i18n.getMessage("help_comp"));$("#usage #help_drag").text(chrome.i18n.getMessage("help_drag"));unpersist();setupLookup()});
