(function(){function d(){var a,b;a=window.location.search.match(/^\?stocks=(.*)/);b=[];if(a&&a.length==2){a=a[1].split(",");for(var c=0;c<a.length;c++)a[c]!=""&&b.push(decodeURI(a[c]))}return b}function e(a){var b,c;for(b=0;b<a.length;b++){c=stockTemplate().show();c.find(".stock_name").text(a[b]);$("#stocks ul").append(c)}}function f(a){a=$.map(QUERY.parseCsv(a),function(b){if(b[0]==="")return null;return{id:b[1],name:b[0]}});a=$.grep(a,function(b){return b});a=loadStocks().concat(a);storeStocks(a);
$("#notification").text(chrome.i18n.getMessage("import_finished"))}function g(){var a;a=d();e(a);$("#notification").addClass("ui-state-highlight").text(chrome.i18n.getMessage("import_before"));$("#import").button({label:chrome.i18n.getMessage("import"),icons:{primary:"ui-icon-gear"}}).click(function(){QUERY.send(QUERY.build(a,QUERY.options("name","symbol")),f);$(this).button("option","disabled",true);return false});if(a.length==0){$("#notification").addClass("ui-state-error").text(chrome.i18n.getMessage("import_empty"));
$("#stocks").hide();$("#import").button("option","disabled",true)}}jQuery(function(){$("#status").ajaxStart(function(){$(this).show()});$("#status").ajaxError(function(){$(this).hide()});$("#status").ajaxStop(function(){$(this).fadeOut(2E3)});$("#notification").ajaxError(function(){$(this).addClass("ui-state-error").text(chrome.i18n.getMessage("import_error"))});g()})})();
